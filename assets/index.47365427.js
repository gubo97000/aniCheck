var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,i)=>{for(var n in i||(i={}))t.call(i,n)&&r(e,n,i[n]);if(a)for(var n of a(i))s.call(i,n)&&r(e,n,i[n]);return e};import{c as n,W as o,r as l,G as c,g as m,u as d,A as u,F as p,I as g,a as y,C as f,b as h,d as E,B as O,M as b,e as v,f as C,S,T as A,h as M,x as N,m as V,i as k,j as T,L as w,k as I,l as L,n as x,o as D,p as P,q as j,s as U,t as R,v as _}from"./vendor.4d1f4bb1.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),r=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,i)=>{const n=new URL(e,s);if(self[t].moduleMap[n])return a(self[t].moduleMap[n]);const o=new Blob([`import * as m from '${n}';`,`${t}.moduleMap['${n}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){i(new Error(`Failed to import: ${e}`)),r(l)},onload(){a(self[t].moduleMap[n]),r(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("/aniCheck/assets/");const z={cy:n({headless:!0}),userOptions:{sort:{type:"alphabetical",inverted:!1},smartCompletition:!0,completition:[],animeComposition:["TV","TV_SHORT","MOVIE","SPECIAL","OVA","ONA","MUSIC"],mangaComposition:["MANGA","ONE_SHOT"]},seriesDict:{}},{Provider:H,useTracked:$}=o((()=>l.useState(z)));function G(){const[e,t]=$();let a=l.useRef(null);return l.useEffect((()=>{let e=n({container:a.current,elements:[{data:{id:"a",title:"Ani"}},{data:{id:"b",title:"Check"}},{data:{id:"ab",source:"a",target:"b"}}],style:[{selector:"node",style:{label:"data(title)"}},{selector:'node[status="NO"]',style:{"background-color":"red"}},{selector:'node[status="COMPLETED"]',style:{"background-color":"green"}},{selector:'node[status="CURRENT"]',style:{"background-color":"cyan"}},{selector:"edge",style:{"curve-style":"bezier",width:6,"target-arrow-shape":"triangle","line-color":"#ffaaaa","target-arrow-color":"#ffaaaa",label:"data(relation)"}},{selector:'edge[relation= "SEQUEL"]',style:{label:"Sequel"}},{selector:'edge[relation= "SIDE_STORY"]',style:{label:"Side Story"}},{selector:'edge[relation= "OTHER"]',style:{label:"Other"}},{selector:'edge[relation= "ADAPTATION"]',style:{label:"Adaptation"}},{selector:'edge[relation= "SOURCE"]',style:{label:"Source"}},{selector:'node[format="MANGA"]',style:{"border-width":"1px",shape:"polygon","shape-polygon-points":"0.846 -0.923 -0.602 -0.923 -0.923 -0.806 -0.923 0.846 -0.692 0.923 0.692 0.923 0.692 -0.692 -0.692 -0.692 -0.692 0.923 -0.692 -0.692 -0.769 -0.769 -0.538 -0.846 0.846 -0.846 0.846 0.769 "}},{selector:'node[format="NOVEL"]',style:{shape:"triangle"}}],layout:{name:"cose"}});e.on("cxttapend","node",(e=>{console.log("cxttapend on node"),window.open(e.target.data("siteUrl"),"_blank")})),e.on("tap","node,edge",(e=>{console.log(e.target.data())})),t((t=>i(i({},t),{cyViz:e})))}),[]),l.createElement(c,{item:!0,xs:9},l.createElement("div",{ref:a,style:{width:"100%",height:"100vh"}}))}const B=m`
query ($user: String!, $type: MediaType){
  MediaListCollection(userName: $user, type: $type) {
    lists {
      entries {
        id
        status
        media {
          id
          title {
            userPreferred
            romaji
            english
          }
          synonyms
          startDate {
            year
            month
            day
          }
          format
          coverImage {
            medium
            color
          }
          bannerImage
          popularity
          siteUrl
          episodes
          duration
          status(version: 2)
          relations {
            nodes {
              id
              title {
                userPreferred
                romaji
                english
              }
              synonyms
              startDate {
                year
                month
                day
              }
              format
              coverImage {
                medium
                color
              }
              bannerImage
              popularity
              siteUrl
              episodes
              duration
              status(version: 2)
            }
            edges {
              id
              relationType(version:2)
              node {
                id
              }
            }
          }
        }
      }
      name
      isCustomList
      isSplitCompletedList
    }
  }
}
`;function F(e,t=null){var a;const[s,r]=l.useState(JSON.parse(null!=(a=localStorage.getItem(e))?a:JSON.stringify(t)));return l.useEffect((()=>{localStorage.setItem(e,JSON.stringify(s))}),[s]),[s,r]}function q(e,t){return e.sort(((e,a)=>t?e.item.stats.selected.per-a.item.stats.selected.per:a.item.stats.selected.per-e.item.stats.selected.per))}function J(e,t){return e.sort(((e,a)=>t?e.rankedValue.localeCompare(a.rankedValue):a.rankedValue.localeCompare(e.rankedValue)))}function W(e,t){return e.sort(((e,a)=>t?e.item.stats.serieMiss+e.item.stats.serieTot-(a.item.stats.serieMiss+a.item.stats.serieTot):a.item.stats.serieMiss+a.item.stats.serieTot-(e.item.stats.serieMiss+e.item.stats.serieTot)))}const K=["TV","TV_SHORT","MOVIE","SPECIAL","OVA","ONA","MUSIC","MANGA","NOVEL","ONE_SHOT"],Q=[{id:"TV",label:"TV",tooltip:"Anime broadcast on television"},{id:"TV_SHORT",label:"TV Short",tooltip:"Anime which are under 15 minutes in length and broadcast on television"},{id:"MOVIE",label:"Movie",tooltip:"Anime movies with a theatrical release"},{id:"SPECIAL",label:"Special",tooltip:"Special episodes that have been included in DVD/Blu-ray releases, picture dramas, pilots, etc"},{id:"OVA",label:"OVA",tooltip:"(Original Video Animation) Anime that have been released directly on DVD/Blu-ray without originally going through a theatrical release or television broadcast"},{id:"ONA",label:"ONA",tooltip:"(Original Net Animation) Anime that have been originally released online or are only available through streaming services."},{id:"MUSIC",label:"Music",tooltip:"Short anime released as a music video"},{id:"MANGA",label:"Manga",tooltip:"Professionally published manga with more than one chapter"},{id:"NOVEL",label:"Novel",tooltip:"Written books released as a series of light novels"},{id:"ONE_SHOT",label:"One Shot",tooltip:"Manga with just one chapter"}];function Y(e,t){switch(e){case"anime":return t.animeComposition;case"manga":return t.mangaComposition;default:return[e]}}function X(e,t){var a,s;let r=0,i=0,n=0;for(const o of e)r+=null!=(a=t[o].tot)?a:0,i+=null!=(s=t[o].miss)?s:0,n+=t[o].tot-t[o].miss;return{tot:r,miss:i,got:n}}function Z(e){e((e=>{if(e.userOptions.smartCompletition)for(const[t,a]of Object.entries(e.seriesDict)){let s=0,r=0,i=0;for(const t of["anime","manga","NOVEL"]){let{got:n,miss:o,tot:l}=X(Y(t,e.userOptions),a.stats);0!=n&&(s+=l,r+=o,i+=n)}e.seriesDict[t].stats.selected={tot:s,miss:r,got:i,per:Math.round(i/s*100)}}else for(const[t,a]of Object.entries(e.seriesDict)){let{got:s,miss:r,tot:i}=X(e.userOptions.completition,a.stats);e.seriesDict[t].stats.selected={tot:i,got:s,miss:r,per:Math.round(s/i*100)}}return i({},e)}))}function ee(){const[e,t]=$();let[a,s]=l.useState(!1),[r,n]=l.useState(""),[o,m]=F("usr","");const O=()=>{b({variables:{user:o,type:"ANIME"}})},[b,v]=d(B,{notifyOnNetworkStatusChange:!0,onCompleted:()=>{C({variables:{user:o,type:"MANGA"}})}}),[C,S]=d(B,{notifyOnNetworkStatusChange:!0,onCompleted:()=>{let a=e.cy;const[s,r]=(e=>{let t=new Map,a=new Map;console.log(e);for(let s of e)for(let e of s.entries){t.set(e.media.id,{data:{id:e.media.id,status:e.status,airStatus:e.media.status,format:e.media.format,title:e.media.title.userPreferred,siteUrl:e.media.siteUrl,bannerImage:e.media.bannerImage,popularity:e.media.popularity,startDate:[e.media.startDate.year,e.media.startDate.month,e.media.startDate.day].join("-")}});for(let a of e.media.relations.nodes)t.get(a.id)||t.set(a.id,{data:{id:a.id,status:"NO",airStatus:a.status,format:a.format,title:a.title.userPreferred,siteUrl:a.siteUrl,popularity:a.popularity,bannerImage:a.bannerImage,startDate:[a.startDate.year,a.startDate.month,a.startDate.day].join("-")}});for(let t of e.media.relations.edges)a.set(t.id,{data:{id:"l"+t.id,source:e.media.id,target:t.node.id,relation:t.relationType}})}return[t,a]})([].concat(v.data.MediaListCollection.lists,S.data.MediaListCollection.lists));console.log(s,r),a.elements().remove(),a.add(Array.from(s.values()).concat(Array.from(r.values())));let n=a.elements().components(),o=[];n.map((e=>{e.filter("edge[relation!='CHARACTER'],node").components().map((t=>{t.nodes().length!=t.filter("node[status='NO']").length&&o.push({series:t,serieComplete:e})}))}));let l=o.map((e=>{let t=e.series.sort(((e,t)=>{let a=parseInt(e.data("popularity")),s=parseInt(t.data("popularity"));return isNaN(a)?999:isNaN(s)?-1:s-a}));return{seriesPrime:t.nodes()[0],series:t,serieComplete:e.serieComplete}})).map((e=>{var t,a,s;let r={};for(let i of["TV","TV_SHORT","MOVIE","SPECIAL","OVA","ONA","MUSIC","MANGA","NOVEL","ONE_SHOT"]){let n=e.series.nodes().filter(`node[format='${i}']`);r[i]={tot:null!=(t=n.length)?t:0,miss:null!=(a=n.filter("node[status='NO']").length)?a:0,got:null!=(s=n.filter("node[status!='NO']").length)?s:0}}return i(i({},e),{stats:r})})),c={};l.map((e=>{c[e.seriesPrime.data("id")]=e})),t((e=>i(i({},e),{seriesList:l,seriesDict:c}))),Z(t),console.log(e)}});return l.useEffect((()=>{v.loading||S.loading?s(!0):s(!1),v.error?n(v.error.message):S.error?n(S.error.message):n(" ")}),[v,S]),l.createElement("div",null,l.createElement(c,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center"},l.createElement(c,{item:!0},l.createElement(u,{variant:"rounded"})),l.createElement(c,{item:!0},l.createElement(p,{sx:{m:1,width:"100%"},variant:"standard"},l.createElement(g,{id:"standard-adornment-password",placeholder:"AniList Nick",value:o,onChange:e=>{m(e.target.value)},onKeyPress:e=>{"Enter"==e.key&&O()},endAdornment:l.createElement(y,{position:"end"},a?l.createElement(f,null):l.createElement(h,{"aria-label":"get user anime",onClick:O}))}),l.createElement(E,{id:"standard-weight-helper-text"},r)))))}const te=()=>{const[e,t]=$(),[a,s]=F("sort",e.userOptions.sort);l.useEffect((()=>{t((e=>i(i({},e),{userOptions:i(i({},e.userOptions),{sort:a})})))}),[a]);const[r,n]=l.useState(null),o=Boolean(r),c=()=>{n(null)},m=e=>{a.type==e?s({type:e,inverted:!a.inverted}):s(i(i({},a),{type:e}))};return l.createElement("div",null,l.createElement(O,{id:"sort-button","aria-controls":"sort-menu","aria-haspopup":"true","aria-expanded":o?"true":void 0,onClick:e=>{n(e.currentTarget)}},"Sort"),l.createElement(b,{id:"sort-menu",anchorEl:r,open:o,onClose:c,MenuListProps:{"aria-labelledby":"sort-button"}},l.createElement(v,{selected:"complete%"==a.type,onClick:()=>m("complete%")},a.inverted?"V":"^"," Complete %"),l.createElement(v,{selected:"alphabetical"==a.type,onClick:()=>m("alphabetical")},a.inverted?"Up":"Do"," Alphabetical"),l.createElement(v,{onClick:c},"Easy Complete"),l.createElement(v,{onClick:c},"Alphabetical"),l.createElement(v,{selected:"size"==a.type,onClick:()=>m("size")},a.inverted?"Up":"Do"," Size")))},ae=()=>{const[e,t]=$();function a(e){t((t=>{switch(e){case"smart":return i(i({},t),{userOptions:i(i({},t.userOptions),{smartCompletition:!t.userOptions.smartCompletition})});case"all":return i(i({},t),{userOptions:i(i({},t.userOptions),{completition:K})});default:return i(i({},t),{userOptions:i(i({},t.userOptions),{completition:N(t.userOptions.completition,[e])})})}}))}return l.useEffect((()=>{Z(t)}),[e.userOptions.completition,e.userOptions.smartCompletition,e.userOptions.mangaComposition,e.userOptions.animeComposition]),l.createElement("div",null,"Completition Calculator",l.createElement(C,{control:l.createElement(S,{checked:e.userOptions.smartCompletition,onClick:()=>a("smart")}),label:"Smart"}),"What is anime? ",Q.map((a=>{if(["TV","TV_SHORT","MOVIE","SPECIAL","OVA","ONA","MUSIC"].includes(a.id))return l.createElement(A,{key:a.label,title:a.tooltip},l.createElement(M,{variant:(s=a.id,e.userOptions.animeComposition.includes(s)?void 0:"outlined"),disabled:!e.userOptions.smartCompletition,label:a.label,onClick:()=>function(e){t((t=>i(i({},t),{userOptions:i(i({},t.userOptions),{animeComposition:N(t.userOptions.animeComposition,[e])})})))}(a.id)}));var s})),"What is Manga? ",Q.map((a=>{if(["MANGA","ONE_SHOT"].includes(a.id))return l.createElement(A,{key:a.label,title:a.tooltip},l.createElement(M,{variant:(s=a.id,e.userOptions.mangaComposition.includes(s)?void 0:"outlined"),disabled:!e.userOptions.smartCompletition,label:a.label,onClick:()=>function(e){t((t=>i(i({},t),{userOptions:i(i({},t.userOptions),{mangaComposition:N(t.userOptions.mangaComposition,[e])})})))}(a.id)}));var s})),"Custom",l.createElement(O,{disabled:e.userOptions.smartCompletition,onClick:()=>a("all")},"All"),Q.map((t=>{return l.createElement(A,{key:t.label,title:t.tooltip},l.createElement(M,{variant:(s=t.id,e.userOptions.completition.includes(s)?void 0:"outlined"),disabled:e.userOptions.smartCompletition,label:t.label,onClick:()=>a(t.id)}));var s})))},se=({children:e})=>{const[t,a]=$();let[s,r]=l.useState(""),[i,n]=l.useState([]);return l.useEffect((()=>{var e;console.log(t.userOptions),n(V(Object.values(null!=(e=t.seriesDict)?e:[]),"",{keys:[e=>e.series.map((e=>e.data("title")))],sorter:e=>(console.log(e),function(e){switch(e){case"complete%":return q;case"alphabetical":return J;case"size":return W;default:return J}}(t.userOptions.sort.type)(e,t.userOptions.sort.inverted))}))}),[t.seriesList,t.userOptions.sort]),l.createElement(k,null,l.createElement(ae,null),l.createElement(T,{value:s,onChange:e=>{var a;r(e.target.value),n(V(Object.values(null!=(a=t.seriesDict)?a:[]),e.target.value,{keys:[e=>e.series.map((e=>e.data("title")))]}))}}),l.createElement(te,null),l.isValidElement(e)?l.cloneElement(e,{seriesToRender:i}):l.createElement("p",null,"Shouldn't display"))},re=({index:e,style:t,data:a})=>{var s,r,n;$();const[o,c]=l.useState(!1);let{addState:m,remState:d,handleToggle:u,seriesList:p,test:g}=a,y=null==(s=p[e])?void 0:s.series,h=null==(r=p[e])?void 0:r.seriesPrime,E=null==(n=p[e])?void 0:n.seriesPrime.data("id");return l.useLayoutEffect((()=>(m({id:E,state:[o,c],series:y}),()=>{d(E)})),[]),l.createElement(k,{style:i({},t),sx:{},key:E},l.createElement(w,{sx:{marginBottom:"10px",border:"1px solid",borderColor:"grey.500",backgroundImage:`url(${h.data("bannerImage")})`,backgroundSize:"cover",color:"white",height:"calc(100% - 10px)",width:"calc(100% - 10px)",borderRadius:"5px",boxShadow:"inset 0 0 0 2000px rgba(0, 0, 0, 0.3)"},selected:o,key:E,button:!0,onClick:()=>{m({id:E,state:[o,c],series:y}),u(E)}},l.createElement(I,{sx:{fontSize:"19px"},id:E,primary:h.data("title")+p[e].stats.selected.per}),l.createElement(k,{sx:{position:"relative",display:"inline-flex"}},l.createElement(f,{variant:"determinate",color:"secondary",value:p[e].stats.mangaPer+20}),l.createElement(k,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"}},l.createElement(f,{variant:"determinate",color:"primary",value:p[e].stats.mangaPer}))),l.createElement(k,{sx:{position:"relative",display:"inline-flex"}},l.createElement(f,{variant:"determinate",color:"secondary",value:p[e].stats.animePer+20}),l.createElement(k,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"}},l.createElement(f,{variant:"determinate",color:"primary",value:p[e].stats.animePer})))))},ie=({seriesToRender:e})=>{const[t,a]=$();let[s,r]=l.useState([]);l.useEffect((()=>{var a;r(null!=(a=null!=e?e:t.seriesList)?a:[])}),[e,t.seriesList]);let[i,n]=l.useState("Very Stupid Fix"),o=l.useMemo((()=>""),[i]);var c=l.useMemo((()=>({})),[i]);const m=e=>{c[e.id]={id:e.id,state:e.state,series:e.series},o==e.id&&e.state[1](!0)},d=e=>{delete c[e]},u=e=>{var a,s,r,i,n,l,m,d;o&&(null==(s=null==(a=null==c?void 0:c[o])?void 0:a.state)||s[1](!1)),o=e,c[e].state[1](!0),console.log(t.cyViz),console.log(null!=(i=null==(r=t.seriesDict)?void 0:r[e])?i:0),null==(n=t.cyViz)||n.elements().remove(),null==(l=t.cyViz)||l.add(c[e].series),null==(m=t.cyViz)||m.elements().makeLayout({name:"breadthfirst",roots:[o]}).run(),null==(d=t.cyViz)||d.center()};function p(e){var a,s;return null!=(s=null==(a=t.seriesList)?void 0:a[e].seriesPrime.data("id"))?s:"1"}return l.createElement(k,{sx:{height:"80vh"}},t.seriesList?l.createElement(L,null,(({height:e,width:t})=>{var a;return l.createElement(x,{height:e,itemSize:140,width:t,itemCount:null!=(a=null==s?void 0:s.length)?a:0,itemData:{addState:m,remState:d,handleToggle:u,seriesList:s},itemKey:p},re)})):l.createElement("p",null,"None"))};function ne(){$();let[e,t]=l.useState("Very Stupid Fix"),a=l.useMemo((()=>""),[e]);var s=l.useMemo((()=>({})),[e]);return l.createElement(c,{sx:{height:"100vh"},item:!0,xs:3},l.createElement(ee,null),l.createElement("p",null,a," ",Object.keys(s).length),l.createElement(se,null,l.createElement(ie,null)))}const oe=new D({uri:"https://graphql.anilist.co",cache:new P}),le=j({palette:{mode:"light"}});U.render(l.createElement(l.StrictMode,null,l.createElement("meta",{name:"viewport",content:"initial-scale=1, width=device-width"}),l.createElement(H,null,l.createElement(R,{client:oe},l.createElement(_,{theme:le},l.createElement(c,{container:!0},l.createElement(G,null),l.createElement(ne,null)))))),document.getElementById("root"));
